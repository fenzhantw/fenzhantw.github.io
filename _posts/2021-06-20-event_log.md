---
title: "[데이터 엔지니어링] GA4 행동 로그 설계하면서 느낀점"
excerpt: ""
categories:
    - Data engineering

tag:
    - Data engineering
    - Event Log

author_profile: true    #작성자 프로필 출력 여부

toc: true   #Table Of Contents 목차 
toc_sticky: true
---

## Intro
서비스를 운영하는데 필요한 트랜잭션(transaction) 로그가 아닌, 고객의 행동 로그를 쌓기 위해서 GA4와 GTM을 이용하였다.
* GTM을 이용하면 개발자의 도움이 없어도 간단한 자바스크립트, HTML 지식으로 원하는 데이터를 수집할 수 있었다.
* 또 무료로 구글의 빅쿼리와 연동하여 원본 데이터에 접근이 가능해졌으며, 빅쿼리를 이용해 고객 행동 데이터를 Jupyter Notebook나 Redash와 같은 BI툴에 연동할 수 있었다.






## 일단 되는대로 다 쌓자!
물론 소제목처럼 정말 되는대로 다 쌓자는 아니였다. 서비스의 주요한 퍼널에 초점을 두고, 필요한 이벤트를 추려냈다. 이러한 작업을 반복하여 GTM Tag를 만들어 배포했고, 배포된 이벤트를 빅쿼리에 일별로 저장해나갔다.






## 많은 회사가 겪는 문제는 이벤트 로그가 없어서가 아니다

회사에서 겪을 수 있는 상황
로깅을 신경쓰지 않고 진행 ⇒ 특정 기능 배포 ⇒ 성과를 확인하려고 하니, 데이터에 누락이 있음을 발견(혹은 잘못된 로깅) ⇒ 다시 로깅을 한 후, 배포 ⇒ 과거 성과는 알 수 없음
이런 경우를 방지하기 위해 데이터 로깅도 항상 진행쓰고 + 데이터 QA도 진행해야 함

- 출처: https://zzsza.github.io/data/2021/06/13/data-event-log-definition/





빅쿼리에 내가 정의한 고객 행동 데이터가 차곡차곡 쌓여 가는 것을 보고 처음에는 매우 기뻤다. 하지만 기쁨도 잠시 목표로한 퍼널 데이터를 분석하기 위해 데이터를 까보니 잘못 쌓이고 있는 데이터가 꽤 있었다. 
그리고 수집하고 있는 데이터 중에 분석에 필요하지 않는 데이터들이 있었다. 퍼널 분석에 필요한 이벤트를 추려냈다고 하지만 여전히 필요하지 않은 이벤트와 속성(key, value)이 존재했다. 
하지만 이미 늦었다. 데이터는 지금도 계속해서 쌓이고 있으며, 잘못 들어온 해당 로그 데이터는 믿을 수 없게 되었다.

데이터 분석가로서 데이터 분석가의 관점에서 "이 데이터가 쌓이면 분석에 어떻게 활용할 수 있지?"를 깊게 고민했어야 했다. 또 모든 지표를 로깅할 수 없기에, 어떤 지표를 핵심 지표로 볼 것인지 정의를 명확하게 내렸으면 더 좋은 로그 데이터가
될 수 있었다. 

추가로 내부 Database에서 쌓고 있는 데이터도 중복으로 쌓고 있었다. 당시에는 서비스 퍼널을 분석하는데 정말 필요하다고 생각했나 보다. 





## 배운점

많은 문제가 있는 행동 로그 쌓기였지만, 배운점은 너무 많다. 
첫번째, 어떤 로그 이벤트를 쌓던지 간에 "로그 설계"가 가장 중요하다. 분석가 뿐만 아니라, 모두가 "이 로그 데이터가 쌓이면 어떤 분석에 활용할 수 있지" 를 깊게 고민해야 한다. 
두번째, 데이터 QA와 로깅 작업은 항상 신경쓰고 정말 제대로 해야 한다. 모든 문제는 이벤트 로그가 없어서가 아니다. 로그 데이터를 신뢰할 수 없기 때문에 생기는 문제이다. 이를 방지하기 위해서는 데이터 QA를 정말 신중하게 진행해야 한다.
세번째, 이벤트 로그 설계한 내용을 잘 기록해 두어야 한다.
네번째, 무작정 많은 데이터를 수집하기 보다는 '필요한' 데이터를 '정확'하게 수집해야 한다.



